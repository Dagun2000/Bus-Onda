<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>관리자 대시보드 | BusOn</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="./css/style.css" />
</head>
<body>
  <header class="topbar">
    <h1>관리자 대시보드</h1>
    <div class="status-pill" id="wsStatus">WS: 연결 대기</div>
  </header>

  <main class="grid">
    <!-- 휴대 단말 -->
    <section class="card">
      <h2>휴대단말 연결</h2>
      <div class="table-wrap">
        <table id="tblPhones">
          <thead>
            <tr>
              <th>IP</th>
              <th>단말 ID</th>
              <th>위도</th>
              <th>경도</th>
              <th>요청 버스</th>
              <th>승차</th>
              <th>하차</th>
              <th>취소</th>
              <th>마지막 활동</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="actions">
        <button data-refresh="phone">새로고침</button>
      </div>

      <div class="quick-actions">
        <h3>휴대 단말 빠른 제어</h3>
        <div class="btn-group">
          <button class="quick-btn" data-command="bus_nearby">근접 신호</button>
          <button class="quick-btn" data-command="bus_arrived">도착 신호</button>
          <button class="quick-btn" data-command="disconnect">연결 끊기</button>
        </div>
      </div>
    </section>


    <!-- 버스 단말 -->
    <section class="card">
      <h2>버스 단말기 연결</h2>
      <div class="table-wrap">
        <table id="tblBuses">
          <thead>
            <tr>
              <th>IP</th>
              <th>버스 번호</th>
              <th>차량 번호</th>
              <th>단말 ID</th>
              <th>마지막 활동</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="actions">
        <button data-refresh="bus">새로고침</button>
        <button data-target="bus" class="btn-command">명령 전송</button>
        <button data-target="bus" class="btn-code">코드 실행</button>
      </div>

      <div class="quick-actions">
        <h3>버스 단말 빠른 제어</h3>
        <div class="btn-group">
          <button class="quick-btn" data-command="ride_request">승차 요청</button>
          <button class="quick-btn" data-command="drop_request">하차 요청</button>
          <button class="quick-btn" data-command="cancel_request">요청 취소</button>
          <button class="quick-btn" data-command="reset">강제 리셋</button>
        </div>
      </div>
    </section>


    <!-- 정류장 단말 -->
    <section class="card">
      <h2>정류장 단말기 연결</h2>
      <div class="table-wrap">
        <table id="tblStops">
          <thead><tr><th>IP</th><th>정류장 ID</th><th>단말 ID</th><th>마지막 활동</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="actions">
        <button data-refresh="stop">새로고침</button>
        <button data-target="stop" class="btn-command">명령 전송</button>
        <button data-target="stop" class="btn-code">코드 실행</button>
      </div>
    </section>

    <!-- 설정/제어 -->
    <section class="card">
      <h2>설정 · 제어</h2>
      <form id="formCommand" class="stack">
        <label>대상 타입
          <select name="targetType">
            <option value="phone">휴대단말</option>
            <option value="bus">버스 단말</option>
            <option value="stop">정류장 단말</option>
          </select>
        </label>
        <label>대상 단말 ID (선택 또는 수동 입력)
          <input type="text" name="targetId" placeholder="예: phone_123 또는 bus_7016_xx" />
        </label>
        <label>명령어
          <input type="text" name="command" placeholder="예: reboot, ping, snapshot 등" />
        </label>
        <button type="submit">명령 전송</button>
      </form>

      <hr />

      <form id="formCode" class="stack">
        <label>대상 타입
          <select name="targetType">
            <option value="phone">휴대단말</option>
            <option value="bus">버스 단말</option>
            <option value="stop">정류장 단말</option>
          </select>
        </label>
        <label>대상 단말 ID
          <input type="text" name="targetId" placeholder="예: bus_pi_01" />
        </label>
        <label>언어
          <select name="language">
            <option value="python">python</option>
            <option value="bash">bash</option>
          </select>
        </label>
        <label>코드
          <textarea name="code" rows="6" placeholder="# 여기에 코드를 입력하세요"></textarea>
        </label>
        <button type="submit">코드 실행</button>
      </form>
    </section>

    <!-- 로그 -->
    <section class="card">
      <h2>로그</h2>
      <div class="log-toolbar">
        <button id="btnLogRefresh">새로고침</button>
        <button id="btnLogClear">화면 지우기</button>
      </div>
      <pre id="logArea" class="log"></pre>
    </section>
  </main>

  //<script src="./js/api.js"></script>
  <script src="./js/main.js"></script>
  <script type="module" src="./js/app.js?v=20251009"></script>

</body>
</html>
